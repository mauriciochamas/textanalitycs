bas <- read.csv("clinical_trial.csv",stringsAsFactors = F)
str(bas)
summary(nchar(bas$abstract))
table(nchar(bas$abstract)==0)
which.min(nchar(bas$title))
bas$title[1258]
library(tm)
corpusT <- Corpus(VectorSource(bas$title))
corpusA <- Corpus(VectorSource(bas$abstract))
corpusT <- tm_map(corpusT,tolower)
corpusA <- tm_map(corpusA,tolower)
corpusT <- tm_map(corpusT,PlainTextDocument)
corpusA <- tm_map(corpusA,PlainTextDocument)
corpusT <- tm_map(corpusT,removePunctuation)
corpusA <- tm_map(corpusA,removePunctuation)
corpusT <- tm_map(corpusT,removeWords,stopwords("en"))
corpusA <- tm_map(corpusA,removeWords,stopwords("en"))
corpusT <- tm_map(corpusT,stemDocument)
corpusA <- tm_map(corpusA,stemDocument)
dtmT <- DocumentTermMatrix(corpusT)
dtmA <- DocumentTermMatrix(corpusA)
spaT <- removeSparseTerms(dtmT,0.95)
spaA <- removeSparseTerms(dtmA,0.95)
dtmT <- as.data.frame(as.matrix(spaT))
dtmA <- as.data.frame(as.matrix(spaA))
head(sort(colSums(dtmA),decreasing = T),10)
csAb <- colSums(dtmA)
which.max(csAb)
colnames(dtmT) <- paste0("T",colnames(dtmT))
colnames(dtmA) <- paste0("A",colnames(dtmA))
dtm <- cbind(dtmT,dtmA)
dtm$trial <- bas$trial
ncol(dtm)
library(caTools)
set.seed(144)
split <- sample.split(dtm$trial,0.7)
train <- subset(dtm,split==T)
test <- subset(dtm,split==F)
table(train$trial)
730/nrow(train)
library(rpart)
library(rpart.plot)
cart <- rpart(trial~.,method = "class",data = train)
prp(cart)
pred <- predict(cart)[,2]
summary(pred)
table(train$trial,pred>=0.5)
1067/nrow(train)
432/(432+140)
635/(635+95)
pred2 <- predict(cart,newdata = test)[,2]
table(test$trial,pred.prob>=0.5)
(255+172)/nrow(test)
library(ROCR)
predroc <- prediction(pred2,test$trial)
as.numeric(performance(predroc,"auc")@y.values)
